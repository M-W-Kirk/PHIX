<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="CDA.xsl"?>
<!--

	Title: US_Realm_Header_Template
	Original Filename: US_Realm_Header_Template.xml
	Version: 1.0
	Revision History:
	01/31/2011 bam created
    07/29/2011 RWM modified

-->
<ClinicalDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="urn:hl7-org:v3 http://xreg2.nist.gov:8080/hitspValidation/schema/cdar2c32/infrastructure/cda/C32_CDA.xsd"
 xmlns="urn:hl7-org:v3"
 xmlns:mif="urn:hl7-org:v3/mif">
	<!--

********************************************************

  CDA Header

********************************************************

	-->
	<realmCode code="US"/>
	<typeId root="2.16.840.1.113883.1.3" extension="POCD_HD000040"/>
	<!-- US General Header Template -->
	<templateId root="2.16.840.1.113883.10.20.22.1.1"/>
	<!-- *** Note:  The next templateId, code and title will differ depending on what type of document is being sent. *** -->
	<!-- conforms to the document specific requirements  -->
	<templateId root="2.16.840.1.113883.10.20.22.1.2"/>
	<id extension="999021" root="2.16.840.1.113883.19"/>
	<code codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" code="34133-9" displayName="Summarization of Episode Note"/>
	<title>PHIX Health Summary</title>
	<effectiveTime value="20050329171504+0500"/>
	<confidentialityCode code="N" codeSystem="2.16.840.1.113883.5.25"/>
	<languageCode code="en-US"/>
	<setId extension="111199021" root="2.16.840.1.113883.19"/>
	<versionNumber value="1"/>
	<recordTarget>
		<patientRole>
			<id extension="12345" root="2.16.840.1.113883.19"/>
			<!-- Fake ID using HL7 example OID. -->
			<id extension="111-00-1234" root="2.16.840.1.113883.4.1"/>
			<!-- Fake Social Security Number using the actual SSN OID. -->
			<addr use="HP">
				<!-- HP is "primary home" from codeSystem 2.16.840.1.113883.5.1119 -->
				<streetAddressLine><%= demographics.address.street %></streetAddressLine>
				<city><%= demographics.address.city %></city>
				<state><%= demographics.address.state %></state>
				<postalCode><%= demographics.address.zip %></postalCode>
				<country><%= demographics.address.country %></country>
				<!-- US is "United States" from ISO 3166-1 Country Codes: 1.0.3166.1 -->
			</addr>
			<telecom value="tel:(781)555-1212" use="HP"/>
			<!-- HP is "primary home" from HL7 AddressUse 2.16.840.1.113883.5.1119 -->
			<patient>
				<name use="L">
					<!-- L is "Legal" from HL7 EntityNameUse 2.16.840.1.113883.5.45 -->
					<prefix><%= demographics.name.prefix %></prefix>
					<% for (i in demographics.name.given) { %>
					<given><%= demographics.name.given[i] %></given>
					<% } %>
					<family><%= demographics.name.family %></family>
				</name>
				<administrativeGenderCode code="" codeSystem="2.16.840.1.113883.5.1" displayName="<%= demographics.gender %>"/>
				<birthTime value="19541125"/>
				<maritalStatusCode code="" displayName="<%= demographics.marital_status %>" codeSystem="2.16.840.1.113883.5.2" codeSystemName="MaritalStatusCode"/>
				<religiousAffiliationCode code="" displayName="<%= demographics.religion %>" codeSystemName="HL7 Religious Affiliation " codeSystem="2.16.840.1.113883.1.11.19185"/>
				<raceCode code="" displayName="<%= demographics.race %>" codeSystem="2.16.840.1.113883.6.238" codeSystemName="Race &amp; Ethnicity - CDC"/>
				<ethnicGroupCode code="" displayName="<%= demographics.ethnicity %>" codeSystem="2.16.840.1.113883.6.238" codeSystemName="Race &amp; Ethnicity - CDC"/>
				<guardian>
					<code code="" displayName="<%= demographics.guardian.relationship %>" codeSystem="2.16.840.1.113883.5.111" codeSystemName="HL7 Role code"/>
					<addr use="HP">
						<!-- HP is "primary home" from codeSystem 2.16.840.1.113883.5.1119 -->
						<streetAddressLine><%= demographics.guardian.address.street %></streetAddressLine>
						<city><%= demographics.guardian.address.city %></city>
						<state><%= demographics.guardian.address.state %></state>
						<postalCode><%= demographics.guardian.address.zip %></postalCode>
						<country><%= demographics.guardian.address.country %></country>
						<!-- US is "United States" from ISO 3166-1 Country Codes: 1.0.3166.1 -->
					</addr>
					<telecom value="<%= demographics.guardian.phone.home %>" use="HP"/>
					<guardianPerson>
						<name>
							<% for (i in demographics.guardian.name.given) { %>
							<given><%= demographics.guardian.name.given[i] %></given>
							<% } %>
							<family><%= demographics.guardian.name.family %></family>
						</name>
					</guardianPerson>
				</guardian>
				<birthplace>
					<place>
						<addr>
							<state><%= demographics.birthplace.state %></state>
							<postalCode><%= demographics.birthplace.zip %></postalCode>
							<country><%= demographics.birthplace.country %></country>
						</addr>
					</place>
				</birthplace>
				<languageCommunication>
					<languageCode code="<%= demographics.language %>"/>
					<modeCode code="RWR" displayName="Recieve Written" codeSystem="2.16.840.1.113883.5.60" codeSystemName="LanguageAbilityMode"/>
					<preferenceInd value="true"/>
				</languageCommunication>
			</patient>
			<providerOrganization>
				<id root="2.16.840.1.113883.19"/>
				<name><%= demographics.provider.organization %></name>
				<telecom use="WP" value="<%= demographics.provider.phone %>"/>
				<addr>
					<streetAddressLine><%= demographics.provider.address.street %></streetAddressLine>
					<city><%= demographics.provider.address.city %></city>
					<state><%= demographics.provider.address.state %></state>
					<postalCode><%= demographics.provider.address.zip %></postalCode>
					<country><%= demographics.provider.address.country %></country>
				</addr>
			</providerOrganization>
		</patientRole>
	</recordTarget>

	<!-- ********************************************************

     CDA Body

     ******************************************************** -->
	<component>
		<structuredBody>
			<!-- *********************** -->
			

********************************************************

Allergies, Adverse Reactions, Alerts

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.6.1"/>
					<!-- Alerts section template -->
					<code code="48765-2" codeSystem="2.16.840.1.113883.6.1"/>
					<title>Allergies, Adverse Reactions, Alerts</title>

					<% for (var i=0; i<allergies.length; i++) { %>

					<entry typeCode="DRIV">
						<act classCode="ACT" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.30"/>
							<!-- ** Allergy problem act ** -->
							<id root="36e3e930-7b14-11db-9fe1-0800200c9a66"/>
							<code code="48765-2" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="Allergies, adverse reactions, alerts"/>
							<statusCode code="<%= allergies[i].status %>"/>
							<effectiveTime value="<%= allergies[i].date_range.start %>">
								<low value="<%= allergies[i].date_range.start %>"/>
								<high value="<%= allergies[i].date_range.end %>"/>
							</effectiveTime>
							<entryRelationship typeCode="SUBJ">
								<observation classCode="OBS" moodCode="EVN">
									<!-- allergy observation template -->
									<templateId root="2.16.840.1.113883.10.20.22.4.7"/>
									<id root="4adc1020-7b14-11db-9fe1-0800200c9a66"/>
									<code code="<%= allergies[i].code %>" displayName="<%= allergies[i].name %>" codeSystem="<%= allergies[i].code_system %>" codeSystemName="<%= allergies[i].code_system_name %>"/>
									<statusCode code="completed"/>
									<effectiveTime>
										<low value="<%= allergies[i].date_range.start %>"/>
									</effectiveTime>
									<value xsi:type="CD" code="<%= allergies[i].reaction_type.code %>" displayName="<%= allergies[i].reaction_type.name %>" codeSystem="<%= allergies[i].reaction_type.code_system %>" codeSystemName="<%= allergies[i].reaction_type.code_system_name %>">
										<originalText>
											<reference value="#reaction<%= i %>"/>
										</originalText>
									</value>
									<participant typeCode="CSM">
										<participantRole classCode="MANU">
											<playingEntity classCode="MMAT">
												<code code="<%= allergies[i].allergen.code %>" displayName="<%= allergies[i].allergen.name %>" codeSystem="<%= allergies[i].allergen.code_system %>" codeSystemName="<%= allergies[i].allergen.code_system_name %>">
													<originalText>
														<reference value="#reaction<%= i %>"/>
													</originalText>
												</code>
												<name>Penicillin</name>
											</playingEntity>
										</participantRole>
									</participant>
									<entryRelationship typeCode="SUBJ">
										<observation classCode="OBS" moodCode="EVN">
											<templateId root="2.16.840.1.113883.10.20.22.4.28"/>
											<!-- Alert status observation template -->
											<code code="33999-4" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="Status"/>
											<statusCode code="completed"/>
											<value xsi:type="CE" code="55561003" codeSystem="2.16.840.1.113883.6.96" displayName="<%= allergies[i].status %>"/>
										</observation>
									</entryRelationship>
									<entryRelationship typeCode="MFST">
										<observation classCode="OBS" moodCode="EVN">
											<templateId root="2.16.840.1.113883.10.20.22.4.9"/>
											<!-- Reaction observation template -->
											<id root="4adc1020-7b14-11db-9fe1-0800200c9a64"/>
											<code nullFlavor="NA"/>
											<text>
												<reference value="#reaction<%= i %>"/>
											</text>
											<statusCode code="completed"/>
											<effectiveTime>
												<low value="20090711"/>
											</effectiveTime>
											<value xsi:type="CD" code="<%= allergies[i].reaction.code %>" codeSystem="<%= allergies[i].reaction.code_system %>" displayName="<%= allergies[i].reaction.name %>"/>
										</observation>
									</entryRelationship>
									<entryRelationship typeCode="SUBJ">
										<observation classCode="OBS" moodCode="EVN">
											<templateId root="2.16.840.1.113883.10.20.22.4.8"/>
											<!-- ** Severity observation template ** -->
											<code code="SEV" displayName="Severity Observation" codeSystem="2.16.840.1.113883.5.4" codeSystemName="ActCode"/>
											<text>
												<reference value="#severity<%= i %>"/>
											</text>
											<statusCode code="completed"/>
											<value xsi:type="CD" code="" displayName="<%= allergies[i].severity %>" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT"/>
										</observation>
									</entryRelationship>
								</observation>
							</entryRelationship>
						</act>
					</entry>

					<% } %>


				</section>
			</component>

			<!--

********************************************************

MEDICATIONS

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.1.1"/>
					<code code="10160-0" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="HISTORY OF MEDICATION USE"/>
					<title>Medications</title>

					<% for (var i=0; i<medications.length; i++) { %>

					<entry typeCode="DRIV">
						<substanceAdministration classCode="SBADM" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.16"/>
							<!-- ** MEDICATION ACTIVITY -->
							<id root="cdbd33f0-6cde-11db-9fe1-0800200c9a66"/>
							<text>
							</text>
							<statusCode code="completed"/>
							<effectiveTime xsi:type="IVL_TS">
								<low value="<%= medications[i].date_range.start %>"/>
								<high value="<%= medications[i].date_range.end %>"/>
							</effectiveTime>
							<!--effectiveTime xsi:type="PIVL_TS" institutionSpecified="true" operator="A">
								<period value="6" unit="h"/>
							</effectiveTime-->
							<routeCode code="<%= medications[i].route.code %>" codeSystem="<%= medications[i].route.code_system %>" codeSystemName="<%= medications[i].route.code_system_name %>" displayName="<%= medications[i].route.name %>"/>
							<doseQuantity value="<%= medications[i].dose_quantity.value %>" unit="<%= medications[i].dose_quantity.unit %>"/>
							<rateQuantity value="<%= medications[i].rate_quantity.value %>" unit="<%= medications[i].rate_quantity.unit %>"/>
							<maxDoseQuantity nullFlavor="UNK">
								<numerator nullFlavor="UNK"/>
								<denominator nullFlavor="UNK"/>
							</maxDoseQuantity>
							<administrationUnitCode code="<%= medications[i].administration.code %>" displayName="<%= medications[i].administration.name %>" codeSystem="<%= medications[i].administration.code_system %>" codeSystemName="<%= medications[i].administration.code_system_name %>"/>
							<consumable>
								<manufacturedProduct>
									<templateId root="2.16.840.1.113883.10.20.22.4.23"/>
									<id/>
									<manufacturedMaterial>
										<code code="<%= medications[i].product.code %>" codeSystem="<%= medications[i].product.code_system %>" displayName="<%= medications[i].product.name %>">
											<translation code="<%= medications[i].product.translation.code %>" displayName="<%= medications[i].product.translation.name %>" codeSystem="<%= medications[i].product.translation.code_system %>" codeSystemName="<%= medications[i].product.translation.code_system_name %>"/>
										</code>
									</manufacturedMaterial>
									<manufacturerOrganization/>
								</manufacturedProduct>
							</consumable>
							<!--performer>
								<assignedEntity>
									<id nullFlavor="NI"/>
									<addr nullFlavor="UNK"/>
									<telecom nullFlavor="UNK"/>
									<representedOrganization>
										<id root="2.16.840.1.113883.19.5"/>
										<name>Good Health Clinic</name>
										<telecom nullFlavor="UNK"/>
										<addr nullFlavor="UNK"/>
									</representedOrganization>
								</assignedEntity>
							</performer-->
							<participant typeCode="CSM">
								<participantRole classCode="MANU">
									<templateId root="2.16.840.1.113883.10.20.22.4.24"/>
									<code code="<%= medications[i].vehicle.code %>" displayName="<%= medications[i].vehicle.name %>" codeSystem="<%= medications[i].vehicle.code_system %>"/>
									<!--playingEntity classCode="MMAT">
										<code code="5955009" displayName="Diethylene Glycol" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT"/>
										<name>Diethylene Glycol</name>
									</playingEntity-->
								</participantRole>
							</participant>
							<entryRelationship typeCode="RSON">
								<observation classCode="COND" moodCode="EVN">
									<templateId root="2.16.840.1.113883.10.20.22.4.19"/>
									<id root="db734647-fc99-424c-a864-7e3cda82e703" extension="45665"/>
									<code code="404684003" displayName="Finding" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT"/>
									<statusCode code="completed"/>
									<value xsi:type="CE" code="<%= medications[i].reason.code %>" displayName="<%= medications[i].reason.name %>" codeSystem="<%= medications[i].reason.code_system %>"/>
								</observation>
							</entryRelationship>
							<!--entryRelationship typeCode="REFR">
								<supply classCode="SPLY" moodCode="INT">
									<templateId root="2.16.840.1.113883.10.20.22.4.17"/>
									<id nullFlavor="NI"/>
									<statusCode code="completed"/>
									<effectiveTime xsi:type="IVL_TS">
										<low value="20020101"/>
										<high nullFlavor="UNK"/>
									</effectiveTime>
									<repeatNumber value="1"/>
									<quantity value="75"/>
									<author>
										<time nullFlavor="UNK"/>
										<assignedAuthor>
											<id/>
											<addr nullFlavor="UNK"/>
											<telecom nullFlavor="UNK"/>
											<assignedPerson>
												<name>
													<prefix>Dr.</prefix>
													<given>Robert</given>
													<family>Michaels</family>
												</name>
											</assignedPerson>
										</assignedAuthor>
									</author>
									<entryRelationship typeCode="SUBJ" inversionInd="true">
										<act classCode="ACT" moodCode="INT">
											<templateId root="2.16.840.1.113883.10.20.22.4.20"/>
											<!-- ** Instructions Template ** -->
											<code code="409073007" codeSystem="2.16.840.1.113883.6.96" displayName="instruction"/>
											<text>label in spanish</text>
											<statusCode code="completed"/>
										</act>
									</entryRelationship>
								</supply>
							</entryRelationship-->
							<!--entryRelationship typeCode="REFR">
								<supply classCode="SPLY" moodCode="EVN">
									<templateId root="2.16.840.1.113883.10.20.22.4.18"/>
									<!-- ** Medication Dispense Template ** -->
									<id root="1.2.3.4.56789.1" extension="cb734647-fc99-424c-a864-7e3cda82e704"/>
									<statusCode code="completed"/>
									<effectiveTime value="20020101"/>
									<repeatNumber value="1"/>
									<quantity value="75"/>
									<performer>
										<time nullFlavor="UNK"/>
										<assignedEntity>
											<id/>
											<addr>
												<streetAddressLine>17 Daws Rd.</streetAddressLine>
												<city>Blue Bell</city>
												<state>MA</state>
												<postalCode>02368</postalCode>
												<country>US</country>
											</addr>
											<telecom nullFlavor="UNK"/>
											<assignedPerson>
												<name>
													<prefix>Dr.</prefix>
													<given>Robert</given>
													<family>Michaels</family>
												</name>
											</assignedPerson>
											<representedOrganization>
												<id root="2.16.840.1.113883.19.5"/>
												<name>Good Health Clinic</name>
												<telecom nullFlavor="UNK"/>
												<addr nullFlavor="UNK"/>
											</representedOrganization>
										</assignedEntity>
									</performer>
								</supply>
							</entryRelationship-->
							<precondition typeCode="PRCN">
								<templateId root="2.16.840.1.113883.10.20.22.4.25"/>
								<criterion>
									<code code="ASSERTION" codeSystem="2.16.840.1.113883.5.4"/>
									<value xsi:type="CE" code="<%= medications[i].precondition.code %>" codeSystem="<%= medications[i].precondition.code_system %>" displayName="<%= medications[i].precondition.name %>"/>
								</criterion>
							</precondition>
						</substanceAdministration>
					</entry>

					<% } %>


				</section>
			</component>

			<!--

********************************************************

PROBLEM LIST

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.5"/>
					<code code="11450-4" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="PROBLEM LIST"/>
					<title>Problems</title>
					<text>
					</text>

					<% for (var i=0; i<problems.length; i++) { %>

					<entry typeCode="DRIV">
						<act classCode="ACT" moodCode="EVN">
							<!-- Problem act template -->
							<templateId root="2.16.840.1.113883.10.20.22.4.3"/>
							<id root="ec8a6ff8-ed4b-4f7e-82c3-e98e58b45de7"/>
							<code nullFlavor="NA"/>
							<statusCode code="completed"/>
							<effectiveTime>
								<low value="<%= problems[i].date_range.start %>"/>
								<high value="<%= problems[i].date_range.end %>"/>
							</effectiveTime>
							<entryRelationship typeCode="SUBJ">
								<observation classCode="OBS" moodCode="EVN">
									<!-- Problem observation template -->
									<templateId root="2.16.840.1.113883.10.20.22.4.4"/>
									<id root="ab1791b0-5c71-11db-b0de-0800200c9a66"/>
									<code code="409586006" codeSystem="2.16.840.1.113883.6.96" displayName="Complaint"/>
									<statusCode code="completed"/>
									<effectiveTime>
										<low value="<%= problems[i].date_range.start %>"/>
									</effectiveTime>
									<value xsi:type="CD" code="<%= problems[i].code %>" codeSystem="<%= problems[i].code_system %>" displayName="<%= problems[i].name %>"/>
									<entryRelationship typeCode="REFR">
										<observation classCode="OBS" moodCode="EVN">
											<!-- Problem status observation template -->
											<templateId root="2.16.840.1.113883.10.20.22.4.6"/>
											<code code="33999-4" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="Status"/>
											<statusCode code="completed"/>
											<value xsi:type="CD" code="55561003" codeSystem="2.16.840.1.113883.6.96" displayName="<%= problems[i].status %>" codeSystemName="SNOMED CT"/>
										</observation>
									</entryRelationship>
									<entryRelationship typeCode="SUBJ" inversionInd="true">
										<observation classCode="OBS" moodCode="EVN">
											<templateId root="2.16.840.1.113883.10.20.22.4.31"/>
											<!--    Age observation template   -->
											<code code="397659008" codeSystem="2.16.840.1.113883.6.96" displayName="Age"/>
											<statusCode code="completed"/>
											<value xsi:type="PQ" value="<%= problems[i].age %>" unit="a"/>
										</observation>
									</entryRelationship>
									<!--entryRelationship typeCode="REFR">
										<observation classCode="OBS" moodCode="EVN">
											<templateId root="2.16.840.1.113883.10.20.22.4.5"/>
											<!-- Health status observation template -->
											<code code="11323-3" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="Health status"/>
											<statusCode code="completed"/>
											<value xsi:type="CE" code="413322009" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT" displayName="Resolved"/>
										</observation>
									</entryRelationship-->
								</observation>
							</entryRelationship>
						</act>
					</entry>

					<% } %>

				</section>
			</component>

			<!--

********************************************************

PROCEDURES

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.7"/>
					<!-- Procedures section template -->
					<code code="47519-4" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="PROCEDURES"/>
					<title>Procedures</title>
					<text>
					</text>

					<% for (var i=0; i<procedures.length; i++) { %>

					<entry typeCode="DRIV">
						<procedure classCode="PROC" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.14"/>
							<!-- ***** Procedure  Activity Procedure Template ***** -->
							<id root="d68b7e32-7810-4f5b-9cc2-acd54b0fd85d"/>
							<code code="<%=procedures[i].code %>" codeSystem="<%=procedures[i].code_system %>" displayName="<%=procedures[i].name %>"/>
								<originalText>
									<reference value="#Proc<%=i%>"/>
								</originalText>
							</code>
							<statusCode code="completed"/>
							<effectiveTime value="20110215"/>
							<methodCode nullFlavor="UNK"/>
							<specimen typeCode="SPC">
								<specimenRole classCode="SPEC">
									<id root="c2ee9ee9-ae31-4628-a919-fec1cbb58683"/>
									<specimenPlayingEntity>
										<code code="<%=procedures[i].specimen.code %>" codeSystem="<%=procedures[i].specimen.code_system %>" displayName="<%=procedures[i].specimen.name %>"/>
									</specimenPlayingEntity>
								</specimenRole>
							</specimen>
							<performer>
								<assignedEntity>
									<id root="c2ee9ee9-ae31-4628-a919-fec1cbb58687"/>
									<addr>
										<streetAddressLine><%=procedures[i].performer.street %></streetAddressLine>
										<city><%=procedures[i].performer.city %></city>
										<state><%=procedures[i].performer.state %></state>
										<postalCode><%=procedures[i].performer.zip %></postalCode>
										<country><%=procedures[i].performer.country %></country>
									</addr>
									<telecom use="WP" value="<%=procedures[i].performer.phone %>"/>
									<representedOrganization>
										<id root="c2ee9ee9-ae31-4628-a919-fec1cbb58686"/>
										<name><%=procedures[i].performer.organization %></name>
										<telecom use="WP" value="<%=procedures[i].performer.phone %>"/>
										<addr>
											<streetAddressLine><%=procedures[i].performer.street %></streetAddressLine>
											<city><%=procedures[i].performer.city %></city>
											<state><%=procedures[i].performer.state %></state>
											<postalCode><%=procedures[i].performer.zip %></postalCode>
											<country><%=procedures[i].performer.country %></country>
										</addr>
									</representedOrganization>
								</assignedEntity>
							</performer>
							<participant typeCode="LOC">
								<participantRole classCode="MANU">
									<templateId root="2.16.840.1.113883.10.20.22.4.37"/>
									<!--   Product instance template   -->
									<id root="eb936010-7b17-11db-9fe1-0800200c9a68"/>
									<playingDevice>
										<code code="<%=procedures[i].device.code %>" codeSystem="<%=procedures[i].device.code_system %>" displayName="<%=procedures[i].device.name %>"/>
									</playingDevice>
									<scopingEntity>
										<id root="eb936010-7b17-11db-9fe1-0800200c9b65"/>
									</scopingEntity>
								</participantRole>
							</participant>
						</procedure>
					</entry>

					<!--entry>
						<observation classCode="OBS" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.13"/>
							<!-- Procedure Activity Observation -->
							<id extension="123456789" root="2.16.840.1.113883.19"/>
							<code code="274025005" codeSystem="2.16.840.1.113883.6.96" displayName="Colonic polypectomy" codeSystemName="SNOMED-CT">
								<originalText>
									<reference value="#Proc1"/>
								</originalText>
							</code>
							<statusCode code="aborted"/>
							<effectiveTime value="20110203"/>
							<priorityCode code="CR" codeSystem="2.16.840.1.113883.5.7" codeSystemName="ActPriority" displayName="Callback results"/>
							<value xsi:type="CD"/>
							<methodCode nullFlavor="UNK"/>
							<targetSiteCode code="416949008" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT" displayName="Abdomen and pelvis"/>
							<performer>
								<assignedEntity>
									<id root="2.16.840.1.113883.19.5" extension="1234"/>
									<addr>
										<streetAddressLine>17 Daws Rd.</streetAddressLine>
										<city>Blue Bell</city>
										<state>MA</state>
										<postalCode>02368</postalCode>
										<country>US</country>
									</addr>
									<telecom use="WP" value="(555)555-555-1234"/>
									<representedOrganization>
										<id root="2.16.840.1.113883.19.5"/>
										<name>Good Health Clinic</name>
										<telecom nullFlavor="UNK"/>
										<addr nullFlavor="UNK"/>
									</representedOrganization>
								</assignedEntity>
							</performer>
							<participant typeCode="LOC">
								<participantRole classCode="SDLOC">
									<templateId root="2.16.840.1.113883.10.20.22.4.32"/>
									<!-- Service Delivery Location template -->
									<code code="GACH" codeSystem="2.16.840.1.113883.5.111" codeSystemName="HL7 RoleCode" displayName="General Acute Care Hospital"/>
									<addr>
										<streetAddressLine>17 Daws Rd.</streetAddressLine>
										<city>Blue Bell</city>
										<state>MA</state>
										<postalCode>02368</postalCode>
										<country>US</country>
									</addr>
									<telecom nullFlavor="UNK"/>
									<playingEntity classCode="PLC">
										<name>Good Health Clinic</name>
									</playingEntity>
								</participantRole>
							</participant>
						</observation>
					</entry>

					<entry>
						<act classCode="ACT" moodCode="INT">
							<templateId root="2.16.840.1.113883.10.20.22.4.12"/>
							<id root="1.2.3.4.5.6.7.8" extension="1234567"/>
							<code code="274025005" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT" displayName="Colonic polypectomy">
								<originalText>
									<reference value="#Proc1"/>
								</originalText>
							</code>
							<statusCode code="completed"/>
							<effectiveTime value="20110203"/>
							<priorityCode code="CR" codeSystem="2.16.840.1.113883.5.7" codeSystemName="ActPriority" displayName="Callback results"/>
							<performer>
								<assignedEntity>
									<id root="2.16.840.1.113883.19" extension="1234"/>
									<addr>
										<streetAddressLine>17 Daws Rd.</streetAddressLine>
										<city>Blue Bell</city>
										<state>MA</state>
										<postalCode>02368</postalCode>
										<country>US</country>
									</addr>
									<telecom use="WP" value="(555)555-555-1234"/>
									<representedOrganization>
										<id root="2.16.840.1.113883.19.5"/>
										<name>Good Health Clinic</name>
										<telecom nullFlavor="UNK"/>
										<addr nullFlavor="UNK"/>
									</representedOrganization>
								</assignedEntity>
							</performer>
							<participant typeCode="LOC">
								<participantRole classCode="SDLOC">
									<templateId root="2.16.840.1.113883.10.20.22.4.32"/>
									<!-- Service Delivery Location template -->
									<code code="GACH" codeSystem="2.16.840.1.113883.5.111" codeSystemName="HL7 RoleCode" displayName="General Acute Care Hospital"/>
									<addr>
										<streetAddressLine>17 Daws Rd.</streetAddressLine>
										<city>Blue Bell</city>
										<state>MA</state>
										<postalCode>02368</postalCode>
										<country>US</country>
									</addr>
									<telecom nullFlavor="UNK"/>
									<playingEntity classCode="PLC">
										<name>Good Health Clinic</name>
									</playingEntity>
								</participantRole>
							</participant>
						</act>
					</entry-->


					<% } %>


				</section>
			</component>

			<!--

********************************************************

RESULTS

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.3.1"/>
					<code code="30954-2" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="RESULTS"/>
					<title>Results</title>
					<text>

					</text>

					<% for (var i=0; i<results.length; i++) { %>


					<entry typeCode="DRIV">
						<organizer classCode="BATTERY" moodCode="EVN">
							<!-- Result organizer template -->
							<templateId root="2.16.840.1.113883.10.20.22.4.1"/>
							<id root="7d5a02b0-67a4-11db-bd13-0800200c9a66"/>
							<code code="<%=results[i].code %>" displayName="<%=results[i].name %>" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT"/>
							<statusCode code="completed"/>

							<% for (var j=0; j<results[i].results.length; j++) { %>


							<component>
								<observation classCode="OBS" moodCode="EVN">
									<!-- Result observation template -->
									<templateId root="2.16.840.1.113883.10.20.22.4.2"/>
									<id root="107c2dc0-67a5-11db-bd13-0800200c9a66"/>
									<code code="<%=results[i].results[j].code%>" displayName="<%=results[i].results[j].name%>" codeSystem="<%=results[i].results[j].code_system%>" codeSystemName="<%=results[i].results[j].code_system_name%>">
										<originalText>
											<reference value="#result<%=j%>"/>
										</originalText>
									</code>
									<statusCode code="completed"/>
									<effectiveTime value="<%=results[i].results[j].date%>"/>
									<value xsi:type="PQ" value="<%=results[i].results[j].value%>" unit="<%=results[i].results[j].unit%>"/>
									<interpretationCode code="N" codeSystem="2.16.840.1.113883.5.83"/>
									<methodCode/>
									<targetSiteCode/>
									<author>
										<time/>
										<assignedAuthor>
											<id/>
										</assignedAuthor>
									</author>
									<referenceRange>
										<observationRange>
											<text></text>
										</observationRange>
									</referenceRange>
								</observation>
							</component>


							<% } %>

						</organizer>
					</entry>

					<% } %>



				</section>
			</component>


			<!--

********************************************************

IMMUNIZATIONS

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.2"/>
					<!--  ********  Immunizations section template   ******** -->
					<code code="11369-6" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="History of immunizations"/>
					<title>Immunizations</title>
					<text>

					</text>

					<% for (var i=0; i<immunizations.length; i++) { %>

					<entry typeCode="DRIV">
						<substanceAdministration classCode="SBADM" moodCode="EVN" negationInd="false">
							<templateId root="2.16.840.1.113883.10.20.22.4.52"/>
							<!--  ********   Immunization activity template    ******** -->
							<id root="e6f1ba43-c0ed-4b9b-9f12-f435d8ad8f92"/>
							<text>
								<reference value="#immun<%=i%>"/>
							</text>
							<statusCode code="completed"/>
							<effectiveTime xsi:type="IVL_TS" value="<%= immunizations[i].date%>"/>
							<routeCode code="<%= immunizations[i].route.code%>" codeSystem="<%= immunizations[i].route.code_system%>" 
								codeSystemName="<%= immunizations[i].route.code_system_name%>" displayName="<%= immunizations[i].route.name%>"/>
							<doseQuantity nullFlavor="UNK"/>
							<consumable>
								<manufacturedProduct>
									<templateId root="2.16.840.1.113883.10.20.22.4.54"/>
									<!--  ********   Immunization Medication Information    ******** -->
									<manufacturedMaterial>
										<code code="<%= immunizations[i].product.code%>" codeSystem="<%= immunizations[i].product.code_system%>" displayName="<%= immunizations[i].product.name%>" codeSystemName="<%= immunizations[i].product.code_system_name%>">
											<originalText>Influenza virus vaccine</originalText>
											<translation code="<%= immunizations[i].product.translation.code%>" displayName="<%= immunizations[i].product.translation.name%>" codeSystemName="<%= immunizations[i].product.translation.code_system_name%>" codeSystem="<%= immunizations[i].product.translation.code_system%>"/>
										</code>
									</manufacturedMaterial>
								</manufacturedProduct>
							</consumable>
							<entryRelationship typeCode="SUBJ">
								<act classCode="ACT" moodCode="INT">
									<templateId root="2.16.840.1.113883.10.20.22.4.20"/>
									<!-- ** Instructions Template ** -->
									<code code="<%= immunizations[i].education_type.code%>" codeSystem="<%= immunizations[i].education_type.code_system%>" displayName="<%= immunizations[i].education_type.name%>"/>
									<text><%= immunizations[i].instructions%></text>
									<statusCode code="completed"/>
								</act>
							</entryRelationship>
						</substanceAdministration>
					</entry>

					<% } %>

				</section>
			</component>

			<!--

********************************************************

ENCOUNTERS

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.22.1"/>
					<!-- Encounters Section - required entries -->
					<code code="46240-8" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="History of encounters"/>
					<title>Encounters</title>
					<text>

					</text>

					<% for (var i=0; i<encounters.length; i++) { %>

					<entry typeCode="DRIV">
						<encounter classCode="ENC" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.49"/>
							<!-- Encounter Activities -->
							<!--  ********  Encounter activity template   ******** -->
							<id root="2a620155-9d11-439e-92b3-5d9815ff4de8"/>
							<code code="<%= encounters[i].code%>" displayName="<%= encounters[i].name%>" codeSystemName="<%= encounters[i].code_system_name%>" codeSystem="<%= encounters[i].code_system%>" codeSystemVersion="<%= encounters[i].code_system_version%>">
								<originalText><reference value="#Encounter<%=1%>"/>
								</originalText>
								<translation code="<%= encounters[i].translation.code%>" codeSystem="<%= encounters[i].translation.code_system%>" displayName="<%= encounters[i].translation.name%>" codeSystemName="<%= encounters[i].translation.code_system_name%>"/>
							</code>
							<effectiveTime value="<%= encounters[i].date%>"/>
							<performer>
								<assignedEntity>
									<id/>
									<code code="<%= encounters[i].performer.code%>" codeSystem="<%= encounters[i].performer.code_system%>" codeSystemName="<%= encounters[i].performer.code_system_name%>" displayName="<%= encounters[i].performer.name%>"/>
								</assignedEntity>
							</performer>
							<participant typeCode="LOC">
								<participantRole classCode="SDLOC">
									<templateId root="2.16.840.1.113883.10.20.22.4.32"/>
									<!-- Service Delivery Location template -->
									<code code="GACH" codeSystem="2.16.840.1.113883.5.111" codeSystemName="HL7 RoleCode" displayName="<%= encounters[i].location.organization%>"/>
									<addr>
										<streetAddressLine><%= encounters[i].location.street%></streetAddressLine>
										<city><%= encounters[i].location.city%></city>
										<state><%= encounters[i].location.state%></state>
										<postalCode><%= encounters[i].location.zip%></postalCode>
										<country><%= encounters[i].location.streer%></country>
									</addr>
									<telecom nullFlavor="UNK"/>
									<!--playingEntity classCode="PLC">
										<name>Good Health Clinic</name>
									</playingEntity-->
								</participantRole>
							</participant>
							<entryRelationship typeCode="RSON">
								<observation classCode="COND" moodCode="EVN">
									<templateId root="2.16.840.1.113883.10.20.22.4.19"/>
									<id root="db734647-fc99-424c-a864-7e3cda82e703" extension="45665"/>
									<code code="404684003" displayName="Finding" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED CT"/>
									<statusCode code="completed"/>
									<value xsi:type="CE" code="<%= encounters[i].finding.code%>" displayName="<%= encounters[i].finding.name%>" codeSystem="<%= encounters[i].finding.code_system%>"/>
								</observation>
							</entryRelationship>
						</encounter>
					</entry>

					<% } %>
				</section>
			</component>

			<!--

********************************************************

VITAL SIGNS

********************************************************

-->
			<component>
				<section>
					<templateId root="2.16.840.1.113883.10.20.22.2.4.1"/>
					<code code="8716-3" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="VITAL SIGNS"/>
					<title>Vital Signs</title>
					<text>
					</text>


					<% for (var i=0; i<vitals.length; i++) { %>


					<entry typeCode="DRIV">
						<organizer classCode="CLUSTER" moodCode="EVN">
							<templateId root="2.16.840.1.113883.10.20.22.4.26"/>
							<!-- Vital signs organizer template -->
							<id root="c6f88320-67ad-11db-bd13-0800200c9a66"/>
							<code code="46680005" codeSystem="2.16.840.1.113883.6.96" codeSystemName="SNOMED -CT" displayName="Vital signs"/>
							<statusCode code="completed"/>
							<effectiveTime value="<%=vitals[i].date%>"/>

							<% for (var j=0; j<vitals[i].results.length;j++) {%>
							<component>
								<observation classCode="OBS" moodCode="EVN">
									<templateId root="2.16.840.1.113883.10.20.22.4.27"/>
									<!-- Vital Sign Observation template -->
									<id root="c6f88321-67ad-11db-bd13-0800200c9a66"/>
									<code code="<%=vitals[i].results[j].code%>" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="<%=vitals[i].results[j].name%>"/>
									<text>
										<reference value="#vit<%=j%>"/>
									</text>
									<statusCode code="completed"/>
									<effectiveTime value="<%=vitals[i].date%>"/>
									<value xsi:type="PQ" value="<%=vitals[i].results[j].value%>" unit="<%=vitals[i].results[j].unit%>"/>
									<interpretationCode code="N" codeSystem="2.16.840.1.113883.5.83"/>
								</observation>
							</component>
							<% } %>
							
						</organizer>
					</entry>


					<% } %>
				</section>
			</component>															

			
			<!--

**Required Sections

Allergies

Medications

Problem List

Procedures

Results



**Optional Sections

Advance Directives

Encounters

Family History

Functional Status

Immunizations

Medical Equipment

Payers

Plan of Care

Social History

Vital Signs

-->
		</structuredBody>
	</component>
</ClinicalDocument>
